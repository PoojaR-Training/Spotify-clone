{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n  return to;\n};\n/* eslint-disable camelcase */\nimport * as React from 'react';\nimport memoize from 'memoize-one';\nimport Actions from './components/Actions';\nimport Content from './components/Content';\nimport Controls from './components/Controls';\nimport ErrorMessage from './components/ErrorMessage';\nimport Info from './components/Info';\nimport Loader from './components/Loader';\nimport Player from './components/Player';\nimport Slider from './components/Slider';\nimport { getDevices, getPlaybackState, next, pause, play, previous, seek, setDevice, setVolume } from './spotify';\nimport { getMergedStyles } from './styles';\nimport { getSpotifyURIType, isEqualArray, loadSpotifyPlayer, parseVolume, round, STATUS, TYPE, validateURI } from './utils';\nvar SpotifyWebPlayer = /** @class */function (_super) {\n  __extends(SpotifyWebPlayer, _super);\n  function SpotifyWebPlayer(props) {\n    var _this = _super.call(this, props) || this;\n    _this.isActive = false;\n    _this.emptyTrack = {\n      artists: '',\n      durationMs: 0,\n      id: '',\n      image: '',\n      name: '',\n      uri: ''\n    };\n    _this.getPlayOptions = memoize(function (data) {\n      var playOptions = {\n        context_uri: undefined,\n        uris: undefined\n      };\n      /* istanbul ignore else */\n      if (data) {\n        var ids = Array.isArray(data) ? data : [data];\n        if (!ids.every(function (d) {\n          return validateURI(d);\n        })) {\n          // eslint-disable-next-line no-console\n          console.error('Invalid URI');\n          return playOptions;\n        }\n        if (ids.some(function (d) {\n          return getSpotifyURIType(d) === 'track';\n        })) {\n          if (!ids.every(function (d) {\n            return getSpotifyURIType(d) === 'track';\n          })) {\n            // eslint-disable-next-line no-console\n            console.warn(\"You can't mix tracks URIs with other types\");\n          }\n          playOptions.uris = ids.filter(function (d) {\n            return validateURI(d) && getSpotifyURIType(d) === 'track';\n          });\n        } else {\n          if (ids.length > 1) {\n            // eslint-disable-next-line no-console\n            console.warn(\"Albums, Artists, Playlists and Podcasts can't have multiple URIs\");\n          }\n          // eslint-disable-next-line prefer-destructuring\n          playOptions.context_uri = ids[0];\n        }\n      }\n      return playOptions;\n    });\n    _this.hasNewToken = false;\n    _this.ref = React.createRef();\n    _this.seekUpdateInterval = 100;\n    _this.handleChangeRange = function (position) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var track, _a, callback, token, progress, percentage, state, error_1;\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              track = this.state.track;\n              _a = this.props, callback = _a.callback, token = _a.token;\n              progress = 0;\n              _b.label = 1;\n            case 1:\n              _b.trys.push([1, 8,, 9]);\n              percentage = position / 100;\n              if (!this.isExternalPlayer) return [3 /*break*/, 3];\n              progress = Math.round(track.durationMs * percentage);\n              return [4 /*yield*/, seek(token, progress)];\n            case 2:\n              _b.sent();\n              this.updateState({\n                position: position,\n                progressMs: progress\n              });\n              return [3 /*break*/, 7];\n            case 3:\n              if (!this.player) return [3 /*break*/, 7];\n              return [4 /*yield*/, this.player.getCurrentState()];\n            case 4:\n              state = _b.sent();\n              if (!state) return [3 /*break*/, 6];\n              progress = Math.round(state.track_window.current_track.duration_ms * percentage);\n              return [4 /*yield*/, this.player.seek(progress)];\n            case 5:\n              _b.sent();\n              this.updateState({\n                position: position,\n                progressMs: progress\n              });\n              return [3 /*break*/, 7];\n            case 6:\n              this.updateState({\n                position: 0\n              });\n              _b.label = 7;\n            case 7:\n              if (callback) {\n                callback(__assign(__assign({}, this.state), {\n                  type: TYPE.PROGRESS\n                }));\n              }\n              return [3 /*break*/, 9];\n            case 8:\n              error_1 = _b.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_1);\n              return [3 /*break*/, 9];\n            case 9:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handleClickTogglePlay = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var isActive, error_2;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              isActive = this.state.isActive;\n              _a.label = 1;\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n              return [4 /*yield*/, this.togglePlay(!this.isExternalPlayer && !isActive)];\n            case 2:\n              _a.sent();\n              return [3 /*break*/, 4];\n            case 3:\n              error_2 = _a.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_2);\n              return [3 /*break*/, 4];\n            case 4:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handleClickPrevious = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var token, error_3;\n        var _this = this;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              _a.trys.push([0, 5,, 6]);\n              if (!this.isExternalPlayer) return [3 /*break*/, 2];\n              token = this.props.token;\n              return [4 /*yield*/, previous(token)];\n            case 1:\n              _a.sent();\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 300);\n              return [3 /*break*/, 4];\n            case 2:\n              if (!this.player) return [3 /*break*/, 4];\n              return [4 /*yield*/, this.player.previousTrack()];\n            case 3:\n              _a.sent();\n              _a.label = 4;\n            case 4:\n              return [3 /*break*/, 6];\n            case 5:\n              error_3 = _a.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_3);\n              return [3 /*break*/, 6];\n            case 6:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handleClickNext = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var token, error_4;\n        var _this = this;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              _a.trys.push([0, 5,, 6]);\n              if (!this.isExternalPlayer) return [3 /*break*/, 2];\n              token = this.props.token;\n              return [4 /*yield*/, next(token)];\n            case 1:\n              _a.sent();\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 300);\n              return [3 /*break*/, 4];\n            case 2:\n              if (!this.player) return [3 /*break*/, 4];\n              return [4 /*yield*/, this.player.nextTrack()];\n            case 3:\n              _a.sent();\n              _a.label = 4;\n            case 4:\n              return [3 /*break*/, 6];\n            case 5:\n              error_4 = _a.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_4);\n              return [3 /*break*/, 6];\n            case 6:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handleClickDevice = function (deviceId) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var isUnsupported, _a, autoPlay, persistDeviceSelection, token, player, error_5;\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              isUnsupported = this.state.isUnsupported;\n              _a = this.props, autoPlay = _a.autoPlay, persistDeviceSelection = _a.persistDeviceSelection, token = _a.token;\n              this.updateState({\n                currentDeviceId: deviceId\n              });\n              _b.label = 1;\n            case 1:\n              _b.trys.push([1, 7,, 8]);\n              return [4 /*yield*/, setDevice(token, deviceId)];\n            case 2:\n              _b.sent();\n              /* istanbul ignore else */\n              if (persistDeviceSelection) {\n                sessionStorage.setItem('rswpDeviceId', deviceId);\n              }\n              if (!isUnsupported) return [3 /*break*/, 6];\n              return [4 /*yield*/, this.syncDevice()];\n            case 3:\n              _b.sent();\n              return [4 /*yield*/, getPlaybackState(token)];\n            case 4:\n              player = _b.sent();\n              if (!(player && !player.is_playing && autoPlay)) return [3 /*break*/, 6];\n              return [4 /*yield*/, this.togglePlay(true)];\n            case 5:\n              _b.sent();\n              _b.label = 6;\n            case 6:\n              return [3 /*break*/, 8];\n            case 7:\n              error_5 = _b.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_5);\n              return [3 /*break*/, 8];\n            case 8:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handleFavoriteStatusChange = function (status) {\n      var isSaved = _this.state.isSaved;\n      var callback = _this.props.callback;\n      _this.updateState({\n        isSaved: status\n      });\n      /* istanbul ignore else */\n      if (isSaved !== status) {\n        callback(__assign(__assign({}, __assign(__assign({}, _this.state), {\n          isSaved: status\n        })), {\n          type: TYPE.FAVORITE\n        }));\n      }\n    };\n    _this.handlePlayerErrors = function (type, message) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var status, isPlaybackError, isInitializationError, nextStatus, devices, token;\n        var _a;\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              status = this.state.status;\n              isPlaybackError = type === 'playback_error';\n              isInitializationError = type === 'initialization_error';\n              nextStatus = status;\n              devices = [];\n              if (!(this.player && !isPlaybackError)) return [3 /*break*/, 2];\n              return [4 /*yield*/, this.player.disconnect()];\n            case 1:\n              _b.sent();\n              _b.label = 2;\n            case 2:\n              if (!isInitializationError) return [3 /*break*/, 4];\n              nextStatus = STATUS.UNSUPPORTED;\n              token = this.props.token;\n              return [4 /*yield*/, getDevices(token)];\n            case 3:\n              _a = _b.sent().devices, devices = _a === void 0 ? [] : _a;\n              _b.label = 4;\n            case 4:\n              if (!isInitializationError && !isPlaybackError) {\n                nextStatus = STATUS.ERROR;\n              }\n              this.updateState({\n                devices: devices,\n                error: message,\n                errorType: type,\n                isInitializing: false,\n                isUnsupported: isInitializationError,\n                status: nextStatus\n              });\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handlePlayerStateChanges = function (state) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var paused, position, _a, _b, album, artists, duration_ms, id, name_1, uri, next_tracks, previous_tracks, isPlaying, volume, track, trackState, error_6;\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              _c.trys.push([0, 6,, 7]);\n              if (!state) return [3 /*break*/, 2];\n              paused = state.paused, position = state.position, _a = state.track_window, _b = _a.current_track, album = _b.album, artists = _b.artists, duration_ms = _b.duration_ms, id = _b.id, name_1 = _b.name, uri = _b.uri, next_tracks = _a.next_tracks, previous_tracks = _a.previous_tracks;\n              isPlaying = !paused;\n              return [4 /*yield*/, this.player.getVolume()];\n            case 1:\n              volume = _c.sent();\n              track = {\n                artists: artists.map(function (d) {\n                  return d.name;\n                }).join(', '),\n                durationMs: duration_ms,\n                id: id,\n                image: this.setAlbumImage(album),\n                name: name_1,\n                uri: uri\n              };\n              trackState = void 0;\n              if (position === 0) {\n                trackState = {\n                  nextTracks: next_tracks,\n                  position: 0,\n                  previousTracks: previous_tracks,\n                  track: track\n                };\n              }\n              this.updateState(__assign({\n                error: '',\n                errorType: '',\n                isActive: true,\n                isPlaying: isPlaying,\n                progressMs: position,\n                volume: round(volume)\n              }, trackState));\n              return [3 /*break*/, 5];\n            case 2:\n              if (!this.isExternalPlayer) return [3 /*break*/, 4];\n              return [4 /*yield*/, this.syncDevice()];\n            case 3:\n              _c.sent();\n              return [3 /*break*/, 5];\n            case 4:\n              this.updateState({\n                isActive: false,\n                isPlaying: false,\n                nextTracks: [],\n                position: 0,\n                previousTracks: [],\n                track: {\n                  artists: '',\n                  durationMs: 0,\n                  id: '',\n                  image: '',\n                  name: '',\n                  uri: ''\n                }\n              });\n              _c.label = 5;\n            case 5:\n              return [3 /*break*/, 7];\n            case 6:\n              error_6 = _c.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_6);\n              return [3 /*break*/, 7];\n            case 7:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handlePlayerStatus = function (_a) {\n      var device_id = _a.device_id;\n      return __awaiter(_this, void 0, void 0, function () {\n        var _b, currentDeviceId, devices;\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              return [4 /*yield*/, this.initializeDevices(device_id)];\n            case 1:\n              _b = _c.sent(), currentDeviceId = _b.currentDeviceId, devices = _b.devices;\n              this.updateState({\n                currentDeviceId: currentDeviceId,\n                deviceId: device_id,\n                devices: devices,\n                isInitializing: false,\n                status: device_id ? STATUS.READY : STATUS.IDLE\n              });\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.handleToggleMagnify = function () {\n      var magnifySliderOnHover = _this.props.magnifySliderOnHover;\n      if (magnifySliderOnHover) {\n        _this.updateState(function (previousState) {\n          return {\n            isMagnified: !previousState.isMagnified\n          };\n        });\n      }\n    };\n    _this.initializePlayer = function () {\n      var volume = _this.state.volume;\n      var _a = _this.props,\n        name = _a.name,\n        token = _a.token;\n      _this.updateState({\n        isInitializing: true\n      });\n      // @ts-ignore\n      _this.player = new window.Spotify.Player({\n        getOAuthToken: function (callback) {\n          callback(token);\n        },\n        name: name,\n        volume: volume\n      });\n      _this.player.addListener('ready', _this.handlePlayerStatus);\n      _this.player.addListener('not_ready', _this.handlePlayerStatus);\n      _this.player.addListener('player_state_changed', _this.handlePlayerStateChanges);\n      _this.player.addListener('initialization_error', function (error) {\n        return _this.handlePlayerErrors('initialization_error', error.message);\n      });\n      _this.player.addListener('authentication_error', function (error) {\n        return _this.handlePlayerErrors('authentication_error', error.message);\n      });\n      _this.player.addListener('account_error', function (error) {\n        return _this.handlePlayerErrors('account_error', error.message);\n      });\n      _this.player.addListener('playback_error', function (error) {\n        return _this.handlePlayerErrors('playback_error', error.message);\n      });\n      _this.player.connect();\n    };\n    _this.setAlbumImage = function (album) {\n      var width = Math.min.apply(Math, __spreadArray([], __read(album.images.map(function (d) {\n        return d.width;\n      }))));\n      var thumb = album.images.find(function (d) {\n        return d.width === width;\n      }) || {};\n      return thumb.url;\n    };\n    _this.setExternalDevice = function (id) {\n      _this.updateState({\n        currentDeviceId: id,\n        isPlaying: true\n      });\n    };\n    _this.setVolume = function (volume) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var token;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              token = this.props.token;\n              if (!this.isExternalPlayer) return [3 /*break*/, 3];\n              return [4 /*yield*/, setVolume(token, Math.round(volume * 100))];\n            case 1:\n              _a.sent();\n              return [4 /*yield*/, this.syncDevice()];\n            case 2:\n              _a.sent();\n              return [3 /*break*/, 5];\n            case 3:\n              if (!this.player) return [3 /*break*/, 5];\n              return [4 /*yield*/, this.player.setVolume(volume)];\n            case 4:\n              _a.sent();\n              _a.label = 5;\n            case 5:\n              this.updateState({\n                volume: volume\n              });\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.syncDevice = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var deviceId, token, player, track, error_7, state;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!this.isActive) {\n                return [2 /*return*/];\n              }\n\n              deviceId = this.state.deviceId;\n              token = this.props.token;\n              _a.label = 1;\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n              return [4 /*yield*/, getPlaybackState(token)];\n            case 2:\n              player = _a.sent();\n              track = this.emptyTrack;\n              if (!player) {\n                throw new Error('No player');\n              }\n              /* istanbul ignore else */\n              if (player.item) {\n                track = {\n                  artists: player.item.artists.map(function (d) {\n                    return d.name;\n                  }).join(', '),\n                  durationMs: player.item.duration_ms,\n                  id: player.item.id,\n                  image: this.setAlbumImage(player.item.album),\n                  name: player.item.name,\n                  uri: player.item.uri\n                };\n              }\n              this.updateState({\n                error: '',\n                errorType: '',\n                isActive: true,\n                isPlaying: player.is_playing,\n                nextTracks: [],\n                previousTracks: [],\n                progressMs: player.item ? player.progress_ms : 0,\n                status: STATUS.READY,\n                track: track,\n                volume: parseVolume(player.device.volume_percent)\n              });\n              return [3 /*break*/, 4];\n            case 3:\n              error_7 = _a.sent();\n              state = {\n                isActive: false,\n                isPlaying: false,\n                position: 0,\n                track: this.emptyTrack\n              };\n              if (deviceId) {\n                this.updateState(__assign({\n                  currentDeviceId: deviceId\n                }, state));\n                return [2 /*return*/];\n              }\n\n              this.updateState(__assign({\n                error: error_7.message,\n                errorType: 'player_status',\n                status: STATUS.ERROR\n              }, state));\n              return [3 /*break*/, 4];\n            case 4:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.toggleOffset = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, currentDeviceId, isPlaying, _b, offset, token, uris;\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              _a = this.state, currentDeviceId = _a.currentDeviceId, isPlaying = _a.isPlaying;\n              _b = this.props, offset = _b.offset, token = _b.token, uris = _b.uris;\n              if (!(isPlaying && typeof offset === 'number' && Array.isArray(uris))) return [3 /*break*/, 2];\n              return [4 /*yield*/, play(token, {\n                deviceId: currentDeviceId,\n                offset: offset,\n                uris: uris\n              })];\n            case 1:\n              _c.sent();\n              _c.label = 2;\n            case 2:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.togglePlay = function (init) {\n      if (init === void 0) {\n        init = false;\n      }\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, currentDeviceId, isPlaying, needsUpdate, _b, offset, token, uris, shouldInitialize, playOptions, playerState, error_8;\n        var _this = this;\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              _a = this.state, currentDeviceId = _a.currentDeviceId, isPlaying = _a.isPlaying, needsUpdate = _a.needsUpdate;\n              _b = this.props, offset = _b.offset, token = _b.token, uris = _b.uris;\n              shouldInitialize = init || needsUpdate;\n              playOptions = this.getPlayOptions(uris);\n              _c.label = 1;\n            case 1:\n              _c.trys.push([1, 12,, 13]);\n              if (!this.isExternalPlayer) return [3 /*break*/, 6];\n              if (!!isPlaying) return [3 /*break*/, 3];\n              return [4 /*yield*/, play(token, __assign({\n                deviceId: currentDeviceId,\n                offset: offset\n              }, shouldInitialize ? playOptions : undefined))];\n            case 2:\n              _c.sent();\n              return [3 /*break*/, 5];\n            case 3:\n              return [4 /*yield*/, pause(token)];\n            case 4:\n              _c.sent();\n              this.updateState({\n                isPlaying: false\n              });\n              _c.label = 5;\n            case 5:\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 300);\n              return [3 /*break*/, 11];\n            case 6:\n              if (!this.player) return [3 /*break*/, 11];\n              return [4 /*yield*/, this.player.getCurrentState()];\n            case 7:\n              playerState = _c.sent();\n              if (!(!playerState && !!(playOptions.context_uri || playOptions.uris) || shouldInitialize && playerState && playerState.paused)) return [3 /*break*/, 9];\n              return [4 /*yield*/, play(token, __assign({\n                deviceId: currentDeviceId,\n                offset: offset\n              }, shouldInitialize ? playOptions : undefined))];\n            case 8:\n              _c.sent();\n              return [3 /*break*/, 11];\n            case 9:\n              return [4 /*yield*/, this.player.togglePlay()];\n            case 10:\n              _c.sent();\n              _c.label = 11;\n            case 11:\n              if (needsUpdate) {\n                this.updateState({\n                  needsUpdate: false\n                });\n              }\n              return [3 /*break*/, 13];\n            case 12:\n              error_8 = _c.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_8);\n              return [3 /*break*/, 13];\n            case 13:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.updateSeekBar = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, progressMs, track, position, state, progress, position, error_9;\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              if (!this.isActive) {\n                return [2 /*return*/];\n              }\n\n              _a = this.state, progressMs = _a.progressMs, track = _a.track;\n              _b.label = 1;\n            case 1:\n              _b.trys.push([1, 5,, 6]);\n              if (!this.isExternalPlayer) return [3 /*break*/, 2];\n              position = progressMs / track.durationMs;\n              position = Number(((Number.isFinite(position) ? position : 0) * 100).toFixed(1));\n              this.updateState({\n                position: position,\n                progressMs: progressMs + this.seekUpdateInterval\n              });\n              return [3 /*break*/, 4];\n            case 2:\n              if (!this.player) return [3 /*break*/, 4];\n              return [4 /*yield*/, this.player.getCurrentState()];\n            case 3:\n              state = _b.sent();\n              /* istanbul ignore else */\n              if (state) {\n                progress = state.position;\n                position = Number((progress / state.track_window.current_track.duration_ms * 100).toFixed(1));\n                this.updateState({\n                  position: position,\n                  progressMs: progress + this.seekUpdateInterval\n                });\n              }\n              _b.label = 4;\n            case 4:\n              return [3 /*break*/, 6];\n            case 5:\n              error_9 = _b.sent();\n              // eslint-disable-next-line no-console\n              console.error(error_9);\n              return [3 /*break*/, 6];\n            case 6:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    _this.updateState = function (state) {\n      if (state === void 0) {\n        state = {};\n      }\n      if (!_this.isActive) {\n        return;\n      }\n      _this.setState(state);\n    };\n    _this.state = {\n      currentDeviceId: '',\n      deviceId: '',\n      devices: [],\n      error: '',\n      errorType: '',\n      isActive: false,\n      isInitializing: false,\n      isMagnified: false,\n      isPlaying: false,\n      isSaved: false,\n      isUnsupported: false,\n      needsUpdate: false,\n      nextTracks: [],\n      playerPosition: 'bottom',\n      position: 0,\n      previousTracks: [],\n      progressMs: 0,\n      status: STATUS.IDLE,\n      track: _this.emptyTrack,\n      volume: parseVolume(props.initialVolume) || 1\n    };\n    _this.styles = getMergedStyles(props.styles);\n    return _this;\n  }\n  SpotifyWebPlayer.prototype.componentDidMount = function () {\n    var _a;\n    return __awaiter(this, void 0, void 0, function () {\n      var _b, top;\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            this.isActive = true;\n            _b = (((_a = this.ref.current) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect()) || {}).top, top = _b === void 0 ? 0 : _b;\n            this.updateState({\n              playerPosition: top > window.innerHeight / 2 ? 'bottom' : 'top',\n              status: STATUS.INITIALIZING\n            });\n            if (!window.onSpotifyWebPlaybackSDKReady) {\n              window.onSpotifyWebPlaybackSDKReady = this.initializePlayer;\n            } else {\n              this.initializePlayer();\n            }\n            return [4 /*yield*/, loadSpotifyPlayer()];\n          case 1:\n            _c.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.componentDidUpdate = function (previousProps, previousState) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, currentDeviceId, deviceId, error, isInitializing, isPlaying, status, track, _b, autoPlay, callback, offset, playProp, showSaveIcon, syncExternalDevice, token, uris, isReady, changedURIs, playOptions, canPlay, shouldPlay, player;\n      var _this = this;\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            _a = this.state, currentDeviceId = _a.currentDeviceId, deviceId = _a.deviceId, error = _a.error, isInitializing = _a.isInitializing, isPlaying = _a.isPlaying, status = _a.status, track = _a.track;\n            _b = this.props, autoPlay = _b.autoPlay, callback = _b.callback, offset = _b.offset, playProp = _b.play, showSaveIcon = _b.showSaveIcon, syncExternalDevice = _b.syncExternalDevice, token = _b.token, uris = _b.uris;\n            isReady = previousState.status !== STATUS.READY && status === STATUS.READY;\n            changedURIs = Array.isArray(uris) ? !isEqualArray(previousProps.uris, uris) : previousProps.uris !== uris;\n            playOptions = this.getPlayOptions(uris);\n            canPlay = !!currentDeviceId && !!(playOptions.context_uri || playOptions.uris);\n            shouldPlay = changedURIs && isPlaying || !!(isReady && (autoPlay || playProp));\n            if (!(canPlay && shouldPlay)) return [3 /*break*/, 2];\n            return [4 /*yield*/, play(token, __assign({\n              deviceId: currentDeviceId,\n              offset: offset\n            }, playOptions))];\n          case 1:\n            _c.sent();\n            /* istanbul ignore else */\n            if (!isPlaying) {\n              this.updateState({\n                isPlaying: true\n              });\n            }\n            if (this.isExternalPlayer) {\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 600);\n            }\n            return [3 /*break*/, 3];\n          case 2:\n            if (changedURIs && !isPlaying) {\n              this.updateState({\n                needsUpdate: true\n              });\n            }\n            _c.label = 3;\n          case 3:\n            if (previousState.status !== status) {\n              callback(__assign(__assign({}, this.state), {\n                type: TYPE.STATUS\n              }));\n            }\n            if (!(previousState.currentDeviceId !== currentDeviceId && currentDeviceId)) return [3 /*break*/, 6];\n            if (!isReady) {\n              callback(__assign(__assign({}, this.state), {\n                type: TYPE.DEVICE\n              }));\n            }\n            return [4 /*yield*/, this.toggleSyncInterval(this.isExternalPlayer)];\n          case 4:\n            _c.sent();\n            return [4 /*yield*/, this.updateSeekBar()];\n          case 5:\n            _c.sent();\n            _c.label = 6;\n          case 6:\n            if (previousState.track.id !== track.id && track.id) {\n              callback(__assign(__assign({}, this.state), {\n                type: TYPE.TRACK\n              }));\n              if (showSaveIcon) {\n                this.updateState({\n                  isSaved: false\n                });\n              }\n            }\n            if (!(previousState.isPlaying !== isPlaying)) return [3 /*break*/, 8];\n            this.toggleProgressBar();\n            return [4 /*yield*/, this.toggleSyncInterval(this.isExternalPlayer)];\n          case 7:\n            _c.sent();\n            callback(__assign(__assign({}, this.state), {\n              type: TYPE.PLAYER\n            }));\n            _c.label = 8;\n          case 8:\n            if (token && previousProps.token !== token) {\n              this.hasNewToken = true;\n              if (!isInitializing) {\n                this.initializePlayer();\n              } else {\n                this.hasNewToken = true;\n              }\n            }\n            if (!(previousProps.play !== playProp && playProp !== isPlaying)) return [3 /*break*/, 10];\n            return [4 /*yield*/, this.togglePlay(!track.id)];\n          case 9:\n            _c.sent();\n            _c.label = 10;\n          case 10:\n            if (!(previousProps.offset !== offset)) return [3 /*break*/, 12];\n            return [4 /*yield*/, this.toggleOffset()];\n          case 11:\n            _c.sent();\n            _c.label = 12;\n          case 12:\n            if (!(previousState.isInitializing && !isInitializing)) return [3 /*break*/, 14];\n            if (error === 'authentication_error' && this.hasNewToken) {\n              this.hasNewToken = false;\n              this.initializePlayer();\n            }\n            if (!(syncExternalDevice && !uris)) return [3 /*break*/, 14];\n            return [4 /*yield*/, getPlaybackState(token)];\n          case 13:\n            player = _c.sent();\n            /* istanbul ignore else */\n            if (player && player.is_playing && player.device.id !== deviceId) {\n              this.setExternalDevice(player.device.id);\n            }\n            _c.label = 14;\n          case 14:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.componentWillUnmount = function () {\n    this.isActive = false;\n    /* istanbul ignore else */\n    if (this.player) {\n      this.player.disconnect();\n    }\n    clearInterval(this.playerSyncInterval);\n    clearInterval(this.playerProgressInterval);\n    clearTimeout(this.syncTimeout);\n  };\n  Object.defineProperty(SpotifyWebPlayer.prototype, \"isExternalPlayer\", {\n    get: function () {\n      var _a = this.state,\n        currentDeviceId = _a.currentDeviceId,\n        deviceId = _a.deviceId,\n        status = _a.status;\n      return currentDeviceId && currentDeviceId !== deviceId || status === STATUS.UNSUPPORTED;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  SpotifyWebPlayer.prototype.initializeDevices = function (id) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, persistDeviceSelection, token, devices, currentDeviceId, savedDeviceId_1;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = this.props, persistDeviceSelection = _a.persistDeviceSelection, token = _a.token;\n            return [4 /*yield*/, getDevices(token)];\n          case 1:\n            devices = _b.sent().devices;\n            currentDeviceId = id;\n            if (persistDeviceSelection) {\n              savedDeviceId_1 = sessionStorage.getItem('rswpDeviceId');\n              /* istanbul ignore else */\n              if (!savedDeviceId_1 || !devices.some(function (d) {\n                return d.id === savedDeviceId_1;\n              })) {\n                sessionStorage.setItem('rswpDeviceId', currentDeviceId);\n              } else {\n                currentDeviceId = savedDeviceId_1;\n              }\n            }\n            return [2 /*return*/, {\n              currentDeviceId: currentDeviceId,\n              devices: devices\n            }];\n        }\n      });\n    });\n  };\n  SpotifyWebPlayer.prototype.toggleSyncInterval = function (shouldSync) {\n    return __awaiter(this, void 0, void 0, function () {\n      var syncExternalDeviceInterval, error_10;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            syncExternalDeviceInterval = this.props.syncExternalDeviceInterval;\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 4,, 5]);\n            if (!(this.isExternalPlayer && shouldSync && !this.playerSyncInterval)) return [3 /*break*/, 3];\n            return [4 /*yield*/, this.syncDevice()];\n          case 2:\n            _a.sent();\n            clearInterval(this.playerSyncInterval);\n            this.playerSyncInterval = window.setInterval(this.syncDevice, syncExternalDeviceInterval * 1000);\n            _a.label = 3;\n          case 3:\n            if ((!shouldSync || !this.isExternalPlayer) && this.playerSyncInterval) {\n              clearInterval(this.playerSyncInterval);\n              this.playerSyncInterval = undefined;\n            }\n            return [3 /*break*/, 5];\n          case 4:\n            error_10 = _a.sent();\n            // eslint-disable-next-line no-console\n            console.error(error_10);\n            return [3 /*break*/, 5];\n          case 5:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.toggleProgressBar = function () {\n    var isPlaying = this.state.isPlaying;\n    /* istanbul ignore else */\n    if (isPlaying) {\n      /* istanbul ignore else */\n      if (!this.playerProgressInterval) {\n        this.playerProgressInterval = window.setInterval(this.updateSeekBar, this.seekUpdateInterval);\n      }\n    } else if (this.playerProgressInterval) {\n      clearInterval(this.playerProgressInterval);\n      this.playerProgressInterval = undefined;\n    }\n  };\n  SpotifyWebPlayer.prototype.render = function () {\n    var _a = this.state,\n      currentDeviceId = _a.currentDeviceId,\n      deviceId = _a.deviceId,\n      devices = _a.devices,\n      error = _a.error,\n      errorType = _a.errorType,\n      isActive = _a.isActive,\n      isMagnified = _a.isMagnified,\n      isPlaying = _a.isPlaying,\n      isUnsupported = _a.isUnsupported,\n      nextTracks = _a.nextTracks,\n      playerPosition = _a.playerPosition,\n      position = _a.position,\n      previousTracks = _a.previousTracks,\n      status = _a.status,\n      track = _a.track,\n      volume = _a.volume;\n    var _b = this.props,\n      name = _b.name,\n      showSaveIcon = _b.showSaveIcon,\n      token = _b.token,\n      updateSavedStatus = _b.updateSavedStatus;\n    var isReady = [STATUS.READY, STATUS.UNSUPPORTED].indexOf(status) >= 0;\n    var isPlaybackError = errorType === 'playback_error';\n    var output = React.createElement(Loader, {\n      styles: this.styles\n    });\n    var info;\n    if (isPlaybackError) {\n      info = React.createElement(\"p\", null, error);\n    }\n    if (isReady) {\n      /* istanbul ignore else */\n      if (!info) {\n        info = React.createElement(Info, {\n          isActive: isActive,\n          onFavoriteStatusChange: this.handleFavoriteStatusChange,\n          showSaveIcon: showSaveIcon,\n          styles: this.styles,\n          token: token,\n          track: track,\n          updateSavedStatus: updateSavedStatus\n        });\n      }\n      output = React.createElement(React.Fragment, null, React.createElement(\"div\", null, info), React.createElement(Controls, {\n        isExternalDevice: this.isExternalPlayer,\n        isPlaying: isPlaying,\n        nextTracks: nextTracks,\n        onClickNext: this.handleClickNext,\n        onClickPrevious: this.handleClickPrevious,\n        onClickTogglePlay: this.handleClickTogglePlay,\n        previousTracks: previousTracks,\n        styles: this.styles\n      }), React.createElement(Actions, {\n        currentDeviceId: currentDeviceId,\n        deviceId: deviceId,\n        devices: devices,\n        isDevicesOpen: isUnsupported && !deviceId,\n        onClickDevice: this.handleClickDevice,\n        playerPosition: playerPosition,\n        setVolume: this.setVolume,\n        styles: this.styles,\n        volume: volume\n      }));\n    }\n    if (status === STATUS.ERROR) {\n      output = React.createElement(ErrorMessage, {\n        styles: this.styles\n      }, name, \": \", error);\n    }\n    return React.createElement(Player, {\n      ref: this.ref,\n      styles: this.styles\n    }, isReady && React.createElement(Slider, {\n      isMagnified: isMagnified,\n      onChangeRange: this.handleChangeRange,\n      onToggleMagnify: this.handleToggleMagnify,\n      position: position,\n      styles: this.styles\n    }), React.createElement(Content, {\n      styles: this.styles\n    }, output));\n  };\n  // eslint-disable-next-line react/static-property-placement\n  SpotifyWebPlayer.defaultProps = {\n    callback: function () {\n      return undefined;\n    },\n    magnifySliderOnHover: false,\n    name: 'Spotify Web Player',\n    showSaveIcon: false,\n    syncExternalDeviceInterval: 5,\n    syncExternalDevice: false\n  };\n  return SpotifyWebPlayer;\n}(React.PureComponent);\nexport { STATUS, TYPE };\nexport * from './types';\nexport default SpotifyWebPlayer;","map":{"version":3,"sources":["../src/index.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\n/* eslint-disable camelcase */\nimport * as React from 'react';\nimport memoize from 'memoize-one';\nimport Actions from './components/Actions';\nimport Content from './components/Content';\nimport Controls from './components/Controls';\nimport ErrorMessage from './components/ErrorMessage';\nimport Info from './components/Info';\nimport Loader from './components/Loader';\nimport Player from './components/Player';\nimport Slider from './components/Slider';\nimport { getDevices, getPlaybackState, next, pause, play, previous, seek, setDevice, setVolume, } from './spotify';\nimport { getMergedStyles } from './styles';\nimport { getSpotifyURIType, isEqualArray, loadSpotifyPlayer, parseVolume, round, STATUS, TYPE, validateURI, } from './utils';\nvar SpotifyWebPlayer = /** @class */ (function (_super) {\n    __extends(SpotifyWebPlayer, _super);\n    function SpotifyWebPlayer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.isActive = false;\n        _this.emptyTrack = {\n            artists: '',\n            durationMs: 0,\n            id: '',\n            image: '',\n            name: '',\n            uri: '',\n        };\n        _this.getPlayOptions = memoize(function (data) {\n            var playOptions = {\n                context_uri: undefined,\n                uris: undefined,\n            };\n            /* istanbul ignore else */\n            if (data) {\n                var ids = Array.isArray(data) ? data : [data];\n                if (!ids.every(function (d) { return validateURI(d); })) {\n                    // eslint-disable-next-line no-console\n                    console.error('Invalid URI');\n                    return playOptions;\n                }\n                if (ids.some(function (d) { return getSpotifyURIType(d) === 'track'; })) {\n                    if (!ids.every(function (d) { return getSpotifyURIType(d) === 'track'; })) {\n                        // eslint-disable-next-line no-console\n                        console.warn(\"You can't mix tracks URIs with other types\");\n                    }\n                    playOptions.uris = ids.filter(function (d) { return validateURI(d) && getSpotifyURIType(d) === 'track'; });\n                }\n                else {\n                    if (ids.length > 1) {\n                        // eslint-disable-next-line no-console\n                        console.warn(\"Albums, Artists, Playlists and Podcasts can't have multiple URIs\");\n                    }\n                    // eslint-disable-next-line prefer-destructuring\n                    playOptions.context_uri = ids[0];\n                }\n            }\n            return playOptions;\n        });\n        _this.hasNewToken = false;\n        _this.ref = React.createRef();\n        _this.seekUpdateInterval = 100;\n        _this.handleChangeRange = function (position) { return __awaiter(_this, void 0, void 0, function () {\n            var track, _a, callback, token, progress, percentage, state, error_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        track = this.state.track;\n                        _a = this.props, callback = _a.callback, token = _a.token;\n                        progress = 0;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 8, , 9]);\n                        percentage = position / 100;\n                        if (!this.isExternalPlayer) return [3 /*break*/, 3];\n                        progress = Math.round(track.durationMs * percentage);\n                        return [4 /*yield*/, seek(token, progress)];\n                    case 2:\n                        _b.sent();\n                        this.updateState({\n                            position: position,\n                            progressMs: progress,\n                        });\n                        return [3 /*break*/, 7];\n                    case 3:\n                        if (!this.player) return [3 /*break*/, 7];\n                        return [4 /*yield*/, this.player.getCurrentState()];\n                    case 4:\n                        state = (_b.sent());\n                        if (!state) return [3 /*break*/, 6];\n                        progress = Math.round(state.track_window.current_track.duration_ms * percentage);\n                        return [4 /*yield*/, this.player.seek(progress)];\n                    case 5:\n                        _b.sent();\n                        this.updateState({\n                            position: position,\n                            progressMs: progress,\n                        });\n                        return [3 /*break*/, 7];\n                    case 6:\n                        this.updateState({ position: 0 });\n                        _b.label = 7;\n                    case 7:\n                        if (callback) {\n                            callback(__assign(__assign({}, this.state), { type: TYPE.PROGRESS }));\n                        }\n                        return [3 /*break*/, 9];\n                    case 8:\n                        error_1 = _b.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_1);\n                        return [3 /*break*/, 9];\n                    case 9: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handleClickTogglePlay = function () { return __awaiter(_this, void 0, void 0, function () {\n            var isActive, error_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        isActive = this.state.isActive;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.togglePlay(!this.isExternalPlayer && !isActive)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_2 = _a.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handleClickPrevious = function () { return __awaiter(_this, void 0, void 0, function () {\n            var token, error_3;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        if (!this.isExternalPlayer) return [3 /*break*/, 2];\n                        token = this.props.token;\n                        return [4 /*yield*/, previous(token)];\n                    case 1:\n                        _a.sent();\n                        this.syncTimeout = window.setTimeout(function () {\n                            _this.syncDevice();\n                        }, 300);\n                        return [3 /*break*/, 4];\n                    case 2:\n                        if (!this.player) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.player.previousTrack()];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        error_3 = _a.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_3);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handleClickNext = function () { return __awaiter(_this, void 0, void 0, function () {\n            var token, error_4;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        if (!this.isExternalPlayer) return [3 /*break*/, 2];\n                        token = this.props.token;\n                        return [4 /*yield*/, next(token)];\n                    case 1:\n                        _a.sent();\n                        this.syncTimeout = window.setTimeout(function () {\n                            _this.syncDevice();\n                        }, 300);\n                        return [3 /*break*/, 4];\n                    case 2:\n                        if (!this.player) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.player.nextTrack()];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        error_4 = _a.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_4);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handleClickDevice = function (deviceId) { return __awaiter(_this, void 0, void 0, function () {\n            var isUnsupported, _a, autoPlay, persistDeviceSelection, token, player, error_5;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        isUnsupported = this.state.isUnsupported;\n                        _a = this.props, autoPlay = _a.autoPlay, persistDeviceSelection = _a.persistDeviceSelection, token = _a.token;\n                        this.updateState({ currentDeviceId: deviceId });\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 7, , 8]);\n                        return [4 /*yield*/, setDevice(token, deviceId)];\n                    case 2:\n                        _b.sent();\n                        /* istanbul ignore else */\n                        if (persistDeviceSelection) {\n                            sessionStorage.setItem('rswpDeviceId', deviceId);\n                        }\n                        if (!isUnsupported) return [3 /*break*/, 6];\n                        return [4 /*yield*/, this.syncDevice()];\n                    case 3:\n                        _b.sent();\n                        return [4 /*yield*/, getPlaybackState(token)];\n                    case 4:\n                        player = _b.sent();\n                        if (!(player && !player.is_playing && autoPlay)) return [3 /*break*/, 6];\n                        return [4 /*yield*/, this.togglePlay(true)];\n                    case 5:\n                        _b.sent();\n                        _b.label = 6;\n                    case 6: return [3 /*break*/, 8];\n                    case 7:\n                        error_5 = _b.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_5);\n                        return [3 /*break*/, 8];\n                    case 8: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handleFavoriteStatusChange = function (status) {\n            var isSaved = _this.state.isSaved;\n            var callback = _this.props.callback;\n            _this.updateState({ isSaved: status });\n            /* istanbul ignore else */\n            if (isSaved !== status) {\n                callback(__assign(__assign({}, __assign(__assign({}, _this.state), { isSaved: status })), { type: TYPE.FAVORITE }));\n            }\n        };\n        _this.handlePlayerErrors = function (type, message) { return __awaiter(_this, void 0, void 0, function () {\n            var status, isPlaybackError, isInitializationError, nextStatus, devices, token;\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        status = this.state.status;\n                        isPlaybackError = type === 'playback_error';\n                        isInitializationError = type === 'initialization_error';\n                        nextStatus = status;\n                        devices = [];\n                        if (!(this.player && !isPlaybackError)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.player.disconnect()];\n                    case 1:\n                        _b.sent();\n                        _b.label = 2;\n                    case 2:\n                        if (!isInitializationError) return [3 /*break*/, 4];\n                        nextStatus = STATUS.UNSUPPORTED;\n                        token = this.props.token;\n                        return [4 /*yield*/, getDevices(token)];\n                    case 3:\n                        (_a = (_b.sent()).devices, devices = _a === void 0 ? [] : _a);\n                        _b.label = 4;\n                    case 4:\n                        if (!isInitializationError && !isPlaybackError) {\n                            nextStatus = STATUS.ERROR;\n                        }\n                        this.updateState({\n                            devices: devices,\n                            error: message,\n                            errorType: type,\n                            isInitializing: false,\n                            isUnsupported: isInitializationError,\n                            status: nextStatus,\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handlePlayerStateChanges = function (state) { return __awaiter(_this, void 0, void 0, function () {\n            var paused, position, _a, _b, album, artists, duration_ms, id, name_1, uri, next_tracks, previous_tracks, isPlaying, volume, track, trackState, error_6;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _c.trys.push([0, 6, , 7]);\n                        if (!state) return [3 /*break*/, 2];\n                        paused = state.paused, position = state.position, _a = state.track_window, _b = _a.current_track, album = _b.album, artists = _b.artists, duration_ms = _b.duration_ms, id = _b.id, name_1 = _b.name, uri = _b.uri, next_tracks = _a.next_tracks, previous_tracks = _a.previous_tracks;\n                        isPlaying = !paused;\n                        return [4 /*yield*/, this.player.getVolume()];\n                    case 1:\n                        volume = _c.sent();\n                        track = {\n                            artists: artists.map(function (d) { return d.name; }).join(', '),\n                            durationMs: duration_ms,\n                            id: id,\n                            image: this.setAlbumImage(album),\n                            name: name_1,\n                            uri: uri,\n                        };\n                        trackState = void 0;\n                        if (position === 0) {\n                            trackState = {\n                                nextTracks: next_tracks,\n                                position: 0,\n                                previousTracks: previous_tracks,\n                                track: track,\n                            };\n                        }\n                        this.updateState(__assign({ error: '', errorType: '', isActive: true, isPlaying: isPlaying, progressMs: position, volume: round(volume) }, trackState));\n                        return [3 /*break*/, 5];\n                    case 2:\n                        if (!this.isExternalPlayer) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.syncDevice()];\n                    case 3:\n                        _c.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.updateState({\n                            isActive: false,\n                            isPlaying: false,\n                            nextTracks: [],\n                            position: 0,\n                            previousTracks: [],\n                            track: {\n                                artists: '',\n                                durationMs: 0,\n                                id: '',\n                                image: '',\n                                name: '',\n                                uri: '',\n                            },\n                        });\n                        _c.label = 5;\n                    case 5: return [3 /*break*/, 7];\n                    case 6:\n                        error_6 = _c.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_6);\n                        return [3 /*break*/, 7];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.handlePlayerStatus = function (_a) {\n            var device_id = _a.device_id;\n            return __awaiter(_this, void 0, void 0, function () {\n                var _b, currentDeviceId, devices;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0: return [4 /*yield*/, this.initializeDevices(device_id)];\n                        case 1:\n                            _b = _c.sent(), currentDeviceId = _b.currentDeviceId, devices = _b.devices;\n                            this.updateState({\n                                currentDeviceId: currentDeviceId,\n                                deviceId: device_id,\n                                devices: devices,\n                                isInitializing: false,\n                                status: device_id ? STATUS.READY : STATUS.IDLE,\n                            });\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        };\n        _this.handleToggleMagnify = function () {\n            var magnifySliderOnHover = _this.props.magnifySliderOnHover;\n            if (magnifySliderOnHover) {\n                _this.updateState(function (previousState) {\n                    return { isMagnified: !previousState.isMagnified };\n                });\n            }\n        };\n        _this.initializePlayer = function () {\n            var volume = _this.state.volume;\n            var _a = _this.props, name = _a.name, token = _a.token;\n            _this.updateState({ isInitializing: true });\n            // @ts-ignore\n            _this.player = new window.Spotify.Player({\n                getOAuthToken: function (callback) {\n                    callback(token);\n                },\n                name: name,\n                volume: volume,\n            });\n            _this.player.addListener('ready', _this.handlePlayerStatus);\n            _this.player.addListener('not_ready', _this.handlePlayerStatus);\n            _this.player.addListener('player_state_changed', _this.handlePlayerStateChanges);\n            _this.player.addListener('initialization_error', function (error) {\n                return _this.handlePlayerErrors('initialization_error', error.message);\n            });\n            _this.player.addListener('authentication_error', function (error) {\n                return _this.handlePlayerErrors('authentication_error', error.message);\n            });\n            _this.player.addListener('account_error', function (error) {\n                return _this.handlePlayerErrors('account_error', error.message);\n            });\n            _this.player.addListener('playback_error', function (error) {\n                return _this.handlePlayerErrors('playback_error', error.message);\n            });\n            _this.player.connect();\n        };\n        _this.setAlbumImage = function (album) {\n            var width = Math.min.apply(Math, __spreadArray([], __read(album.images.map(function (d) { return d.width; }))));\n            var thumb = album.images.find(function (d) { return d.width === width; }) || {};\n            return thumb.url;\n        };\n        _this.setExternalDevice = function (id) {\n            _this.updateState({ currentDeviceId: id, isPlaying: true });\n        };\n        _this.setVolume = function (volume) { return __awaiter(_this, void 0, void 0, function () {\n            var token;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        token = this.props.token;\n                        if (!this.isExternalPlayer) return [3 /*break*/, 3];\n                        return [4 /*yield*/, setVolume(token, Math.round(volume * 100))];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.syncDevice()];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 3:\n                        if (!this.player) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.player.setVolume(volume)];\n                    case 4:\n                        _a.sent();\n                        _a.label = 5;\n                    case 5:\n                        this.updateState({ volume: volume });\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.syncDevice = function () { return __awaiter(_this, void 0, void 0, function () {\n            var deviceId, token, player, track, error_7, state;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.isActive) {\n                            return [2 /*return*/];\n                        }\n                        deviceId = this.state.deviceId;\n                        token = this.props.token;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, getPlaybackState(token)];\n                    case 2:\n                        player = _a.sent();\n                        track = this.emptyTrack;\n                        if (!player) {\n                            throw new Error('No player');\n                        }\n                        /* istanbul ignore else */\n                        if (player.item) {\n                            track = {\n                                artists: player.item.artists.map(function (d) { return d.name; }).join(', '),\n                                durationMs: player.item.duration_ms,\n                                id: player.item.id,\n                                image: this.setAlbumImage(player.item.album),\n                                name: player.item.name,\n                                uri: player.item.uri,\n                            };\n                        }\n                        this.updateState({\n                            error: '',\n                            errorType: '',\n                            isActive: true,\n                            isPlaying: player.is_playing,\n                            nextTracks: [],\n                            previousTracks: [],\n                            progressMs: player.item ? player.progress_ms : 0,\n                            status: STATUS.READY,\n                            track: track,\n                            volume: parseVolume(player.device.volume_percent),\n                        });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_7 = _a.sent();\n                        state = {\n                            isActive: false,\n                            isPlaying: false,\n                            position: 0,\n                            track: this.emptyTrack,\n                        };\n                        if (deviceId) {\n                            this.updateState(__assign({ currentDeviceId: deviceId }, state));\n                            return [2 /*return*/];\n                        }\n                        this.updateState(__assign({ error: error_7.message, errorType: 'player_status', status: STATUS.ERROR }, state));\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.toggleOffset = function () { return __awaiter(_this, void 0, void 0, function () {\n            var _a, currentDeviceId, isPlaying, _b, offset, token, uris;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _a = this.state, currentDeviceId = _a.currentDeviceId, isPlaying = _a.isPlaying;\n                        _b = this.props, offset = _b.offset, token = _b.token, uris = _b.uris;\n                        if (!(isPlaying && typeof offset === 'number' && Array.isArray(uris))) return [3 /*break*/, 2];\n                        return [4 /*yield*/, play(token, { deviceId: currentDeviceId, offset: offset, uris: uris })];\n                    case 1:\n                        _c.sent();\n                        _c.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.togglePlay = function (init) {\n            if (init === void 0) { init = false; }\n            return __awaiter(_this, void 0, void 0, function () {\n                var _a, currentDeviceId, isPlaying, needsUpdate, _b, offset, token, uris, shouldInitialize, playOptions, playerState, error_8;\n                var _this = this;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            _a = this.state, currentDeviceId = _a.currentDeviceId, isPlaying = _a.isPlaying, needsUpdate = _a.needsUpdate;\n                            _b = this.props, offset = _b.offset, token = _b.token, uris = _b.uris;\n                            shouldInitialize = init || needsUpdate;\n                            playOptions = this.getPlayOptions(uris);\n                            _c.label = 1;\n                        case 1:\n                            _c.trys.push([1, 12, , 13]);\n                            if (!this.isExternalPlayer) return [3 /*break*/, 6];\n                            if (!!isPlaying) return [3 /*break*/, 3];\n                            return [4 /*yield*/, play(token, __assign({ deviceId: currentDeviceId, offset: offset }, (shouldInitialize ? playOptions : undefined)))];\n                        case 2:\n                            _c.sent();\n                            return [3 /*break*/, 5];\n                        case 3: return [4 /*yield*/, pause(token)];\n                        case 4:\n                            _c.sent();\n                            this.updateState({ isPlaying: false });\n                            _c.label = 5;\n                        case 5:\n                            this.syncTimeout = window.setTimeout(function () {\n                                _this.syncDevice();\n                            }, 300);\n                            return [3 /*break*/, 11];\n                        case 6:\n                            if (!this.player) return [3 /*break*/, 11];\n                            return [4 /*yield*/, this.player.getCurrentState()];\n                        case 7:\n                            playerState = _c.sent();\n                            if (!((!playerState && !!(playOptions.context_uri || playOptions.uris)) ||\n                                (shouldInitialize && playerState && playerState.paused))) return [3 /*break*/, 9];\n                            return [4 /*yield*/, play(token, __assign({ deviceId: currentDeviceId, offset: offset }, (shouldInitialize ? playOptions : undefined)))];\n                        case 8:\n                            _c.sent();\n                            return [3 /*break*/, 11];\n                        case 9: return [4 /*yield*/, this.player.togglePlay()];\n                        case 10:\n                            _c.sent();\n                            _c.label = 11;\n                        case 11:\n                            if (needsUpdate) {\n                                this.updateState({ needsUpdate: false });\n                            }\n                            return [3 /*break*/, 13];\n                        case 12:\n                            error_8 = _c.sent();\n                            // eslint-disable-next-line no-console\n                            console.error(error_8);\n                            return [3 /*break*/, 13];\n                        case 13: return [2 /*return*/];\n                    }\n                });\n            });\n        };\n        _this.updateSeekBar = function () { return __awaiter(_this, void 0, void 0, function () {\n            var _a, progressMs, track, position, state, progress, position, error_9;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!this.isActive) {\n                            return [2 /*return*/];\n                        }\n                        _a = this.state, progressMs = _a.progressMs, track = _a.track;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 5, , 6]);\n                        if (!this.isExternalPlayer) return [3 /*break*/, 2];\n                        position = progressMs / track.durationMs;\n                        position = Number(((Number.isFinite(position) ? position : 0) * 100).toFixed(1));\n                        this.updateState({\n                            position: position,\n                            progressMs: progressMs + this.seekUpdateInterval,\n                        });\n                        return [3 /*break*/, 4];\n                    case 2:\n                        if (!this.player) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.player.getCurrentState()];\n                    case 3:\n                        state = (_b.sent());\n                        /* istanbul ignore else */\n                        if (state) {\n                            progress = state.position;\n                            position = Number(((progress / state.track_window.current_track.duration_ms) * 100).toFixed(1));\n                            this.updateState({\n                                position: position,\n                                progressMs: progress + this.seekUpdateInterval,\n                            });\n                        }\n                        _b.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        error_9 = _b.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_9);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.updateState = function (state) {\n            if (state === void 0) { state = {}; }\n            if (!_this.isActive) {\n                return;\n            }\n            _this.setState(state);\n        };\n        _this.state = {\n            currentDeviceId: '',\n            deviceId: '',\n            devices: [],\n            error: '',\n            errorType: '',\n            isActive: false,\n            isInitializing: false,\n            isMagnified: false,\n            isPlaying: false,\n            isSaved: false,\n            isUnsupported: false,\n            needsUpdate: false,\n            nextTracks: [],\n            playerPosition: 'bottom',\n            position: 0,\n            previousTracks: [],\n            progressMs: 0,\n            status: STATUS.IDLE,\n            track: _this.emptyTrack,\n            volume: parseVolume(props.initialVolume) || 1,\n        };\n        _this.styles = getMergedStyles(props.styles);\n        return _this;\n    }\n    SpotifyWebPlayer.prototype.componentDidMount = function () {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var _b, top;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this.isActive = true;\n                        _b = (((_a = this.ref.current) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect()) || {}).top, top = _b === void 0 ? 0 : _b;\n                        this.updateState({\n                            playerPosition: top > window.innerHeight / 2 ? 'bottom' : 'top',\n                            status: STATUS.INITIALIZING,\n                        });\n                        if (!window.onSpotifyWebPlaybackSDKReady) {\n                            window.onSpotifyWebPlaybackSDKReady = this.initializePlayer;\n                        }\n                        else {\n                            this.initializePlayer();\n                        }\n                        return [4 /*yield*/, loadSpotifyPlayer()];\n                    case 1:\n                        _c.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SpotifyWebPlayer.prototype.componentDidUpdate = function (previousProps, previousState) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, currentDeviceId, deviceId, error, isInitializing, isPlaying, status, track, _b, autoPlay, callback, offset, playProp, showSaveIcon, syncExternalDevice, token, uris, isReady, changedURIs, playOptions, canPlay, shouldPlay, player;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _a = this.state, currentDeviceId = _a.currentDeviceId, deviceId = _a.deviceId, error = _a.error, isInitializing = _a.isInitializing, isPlaying = _a.isPlaying, status = _a.status, track = _a.track;\n                        _b = this.props, autoPlay = _b.autoPlay, callback = _b.callback, offset = _b.offset, playProp = _b.play, showSaveIcon = _b.showSaveIcon, syncExternalDevice = _b.syncExternalDevice, token = _b.token, uris = _b.uris;\n                        isReady = previousState.status !== STATUS.READY && status === STATUS.READY;\n                        changedURIs = Array.isArray(uris)\n                            ? !isEqualArray(previousProps.uris, uris)\n                            : previousProps.uris !== uris;\n                        playOptions = this.getPlayOptions(uris);\n                        canPlay = !!currentDeviceId && !!(playOptions.context_uri || playOptions.uris);\n                        shouldPlay = (changedURIs && isPlaying) || !!(isReady && (autoPlay || playProp));\n                        if (!(canPlay && shouldPlay)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, play(token, __assign({ deviceId: currentDeviceId, offset: offset }, playOptions))];\n                    case 1:\n                        _c.sent();\n                        /* istanbul ignore else */\n                        if (!isPlaying) {\n                            this.updateState({ isPlaying: true });\n                        }\n                        if (this.isExternalPlayer) {\n                            this.syncTimeout = window.setTimeout(function () {\n                                _this.syncDevice();\n                            }, 600);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        if (changedURIs && !isPlaying) {\n                            this.updateState({ needsUpdate: true });\n                        }\n                        _c.label = 3;\n                    case 3:\n                        if (previousState.status !== status) {\n                            callback(__assign(__assign({}, this.state), { type: TYPE.STATUS }));\n                        }\n                        if (!(previousState.currentDeviceId !== currentDeviceId && currentDeviceId)) return [3 /*break*/, 6];\n                        if (!isReady) {\n                            callback(__assign(__assign({}, this.state), { type: TYPE.DEVICE }));\n                        }\n                        return [4 /*yield*/, this.toggleSyncInterval(this.isExternalPlayer)];\n                    case 4:\n                        _c.sent();\n                        return [4 /*yield*/, this.updateSeekBar()];\n                    case 5:\n                        _c.sent();\n                        _c.label = 6;\n                    case 6:\n                        if (previousState.track.id !== track.id && track.id) {\n                            callback(__assign(__assign({}, this.state), { type: TYPE.TRACK }));\n                            if (showSaveIcon) {\n                                this.updateState({ isSaved: false });\n                            }\n                        }\n                        if (!(previousState.isPlaying !== isPlaying)) return [3 /*break*/, 8];\n                        this.toggleProgressBar();\n                        return [4 /*yield*/, this.toggleSyncInterval(this.isExternalPlayer)];\n                    case 7:\n                        _c.sent();\n                        callback(__assign(__assign({}, this.state), { type: TYPE.PLAYER }));\n                        _c.label = 8;\n                    case 8:\n                        if (token && previousProps.token !== token) {\n                            this.hasNewToken = true;\n                            if (!isInitializing) {\n                                this.initializePlayer();\n                            }\n                            else {\n                                this.hasNewToken = true;\n                            }\n                        }\n                        if (!(previousProps.play !== playProp && playProp !== isPlaying)) return [3 /*break*/, 10];\n                        return [4 /*yield*/, this.togglePlay(!track.id)];\n                    case 9:\n                        _c.sent();\n                        _c.label = 10;\n                    case 10:\n                        if (!(previousProps.offset !== offset)) return [3 /*break*/, 12];\n                        return [4 /*yield*/, this.toggleOffset()];\n                    case 11:\n                        _c.sent();\n                        _c.label = 12;\n                    case 12:\n                        if (!(previousState.isInitializing && !isInitializing)) return [3 /*break*/, 14];\n                        if (error === 'authentication_error' && this.hasNewToken) {\n                            this.hasNewToken = false;\n                            this.initializePlayer();\n                        }\n                        if (!(syncExternalDevice && !uris)) return [3 /*break*/, 14];\n                        return [4 /*yield*/, getPlaybackState(token)];\n                    case 13:\n                        player = _c.sent();\n                        /* istanbul ignore else */\n                        if (player && player.is_playing && player.device.id !== deviceId) {\n                            this.setExternalDevice(player.device.id);\n                        }\n                        _c.label = 14;\n                    case 14: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SpotifyWebPlayer.prototype.componentWillUnmount = function () {\n        this.isActive = false;\n        /* istanbul ignore else */\n        if (this.player) {\n            this.player.disconnect();\n        }\n        clearInterval(this.playerSyncInterval);\n        clearInterval(this.playerProgressInterval);\n        clearTimeout(this.syncTimeout);\n    };\n    Object.defineProperty(SpotifyWebPlayer.prototype, \"isExternalPlayer\", {\n        get: function () {\n            var _a = this.state, currentDeviceId = _a.currentDeviceId, deviceId = _a.deviceId, status = _a.status;\n            return (currentDeviceId && currentDeviceId !== deviceId) || status === STATUS.UNSUPPORTED;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SpotifyWebPlayer.prototype.initializeDevices = function (id) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, persistDeviceSelection, token, devices, currentDeviceId, savedDeviceId_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _a = this.props, persistDeviceSelection = _a.persistDeviceSelection, token = _a.token;\n                        return [4 /*yield*/, getDevices(token)];\n                    case 1:\n                        devices = (_b.sent()).devices;\n                        currentDeviceId = id;\n                        if (persistDeviceSelection) {\n                            savedDeviceId_1 = sessionStorage.getItem('rswpDeviceId');\n                            /* istanbul ignore else */\n                            if (!savedDeviceId_1 || !devices.some(function (d) { return d.id === savedDeviceId_1; })) {\n                                sessionStorage.setItem('rswpDeviceId', currentDeviceId);\n                            }\n                            else {\n                                currentDeviceId = savedDeviceId_1;\n                            }\n                        }\n                        return [2 /*return*/, { currentDeviceId: currentDeviceId, devices: devices }];\n                }\n            });\n        });\n    };\n    SpotifyWebPlayer.prototype.toggleSyncInterval = function (shouldSync) {\n        return __awaiter(this, void 0, void 0, function () {\n            var syncExternalDeviceInterval, error_10;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        syncExternalDeviceInterval = this.props.syncExternalDeviceInterval;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 4, , 5]);\n                        if (!(this.isExternalPlayer && shouldSync && !this.playerSyncInterval)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.syncDevice()];\n                    case 2:\n                        _a.sent();\n                        clearInterval(this.playerSyncInterval);\n                        this.playerSyncInterval = window.setInterval(this.syncDevice, syncExternalDeviceInterval * 1000);\n                        _a.label = 3;\n                    case 3:\n                        if ((!shouldSync || !this.isExternalPlayer) && this.playerSyncInterval) {\n                            clearInterval(this.playerSyncInterval);\n                            this.playerSyncInterval = undefined;\n                        }\n                        return [3 /*break*/, 5];\n                    case 4:\n                        error_10 = _a.sent();\n                        // eslint-disable-next-line no-console\n                        console.error(error_10);\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SpotifyWebPlayer.prototype.toggleProgressBar = function () {\n        var isPlaying = this.state.isPlaying;\n        /* istanbul ignore else */\n        if (isPlaying) {\n            /* istanbul ignore else */\n            if (!this.playerProgressInterval) {\n                this.playerProgressInterval = window.setInterval(this.updateSeekBar, this.seekUpdateInterval);\n            }\n        }\n        else if (this.playerProgressInterval) {\n            clearInterval(this.playerProgressInterval);\n            this.playerProgressInterval = undefined;\n        }\n    };\n    SpotifyWebPlayer.prototype.render = function () {\n        var _a = this.state, currentDeviceId = _a.currentDeviceId, deviceId = _a.deviceId, devices = _a.devices, error = _a.error, errorType = _a.errorType, isActive = _a.isActive, isMagnified = _a.isMagnified, isPlaying = _a.isPlaying, isUnsupported = _a.isUnsupported, nextTracks = _a.nextTracks, playerPosition = _a.playerPosition, position = _a.position, previousTracks = _a.previousTracks, status = _a.status, track = _a.track, volume = _a.volume;\n        var _b = this.props, name = _b.name, showSaveIcon = _b.showSaveIcon, token = _b.token, updateSavedStatus = _b.updateSavedStatus;\n        var isReady = [STATUS.READY, STATUS.UNSUPPORTED].indexOf(status) >= 0;\n        var isPlaybackError = errorType === 'playback_error';\n        var output = React.createElement(Loader, { styles: this.styles });\n        var info;\n        if (isPlaybackError) {\n            info = React.createElement(\"p\", null, error);\n        }\n        if (isReady) {\n            /* istanbul ignore else */\n            if (!info) {\n                info = (React.createElement(Info, { isActive: isActive, onFavoriteStatusChange: this.handleFavoriteStatusChange, showSaveIcon: showSaveIcon, styles: this.styles, token: token, track: track, updateSavedStatus: updateSavedStatus }));\n            }\n            output = (React.createElement(React.Fragment, null,\n                React.createElement(\"div\", null, info),\n                React.createElement(Controls, { isExternalDevice: this.isExternalPlayer, isPlaying: isPlaying, nextTracks: nextTracks, onClickNext: this.handleClickNext, onClickPrevious: this.handleClickPrevious, onClickTogglePlay: this.handleClickTogglePlay, previousTracks: previousTracks, styles: this.styles }),\n                React.createElement(Actions, { currentDeviceId: currentDeviceId, deviceId: deviceId, devices: devices, isDevicesOpen: isUnsupported && !deviceId, onClickDevice: this.handleClickDevice, playerPosition: playerPosition, setVolume: this.setVolume, styles: this.styles, volume: volume })));\n        }\n        if (status === STATUS.ERROR) {\n            output = (React.createElement(ErrorMessage, { styles: this.styles },\n                name,\n                \": \",\n                error));\n        }\n        return (React.createElement(Player, { ref: this.ref, styles: this.styles },\n            isReady && (React.createElement(Slider, { isMagnified: isMagnified, onChangeRange: this.handleChangeRange, onToggleMagnify: this.handleToggleMagnify, position: position, styles: this.styles })),\n            React.createElement(Content, { styles: this.styles }, output)));\n    };\n    // eslint-disable-next-line react/static-property-placement\n    SpotifyWebPlayer.defaultProps = {\n        callback: function () { return undefined; },\n        magnifySliderOnHover: false,\n        name: 'Spotify Web Player',\n        showSaveIcon: false,\n        syncExternalDeviceInterval: 5,\n        syncExternalDevice: false,\n    };\n    return SpotifyWebPlayer;\n}(React.PureComponent));\nexport { STATUS, TYPE };\nexport * from './types';\nexport default SpotifyWebPlayer;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}